<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="sale_order_line_tree_view_procurement" model="ir.ui.view">
        <field name="name">sale.order.line.tree</field>
        <field name="model">sale.order.line</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">
            <tree string="Sale Order Line List" editable="bottom" create="0" delete="0"
                  decoration-danger="qty_remain&lt;0" decoration-warning="qty_remain&gt;0">
                <field name="proc_plan_id" invisible="1"/>
                <field name="product_id" readonly="1"/>
                <field name="qty_remain" sum="Total"/>
                <field name="qty_plan" readonly="1" sum="Total"/>
                <field name="qty_manufacture" sum="Total"/>
                <field name="qty_buy" sum="Total"/>
                <field name="qty_stock" sum="Total"/>
                <field name="product_uom" readonly="1" optional="show" groups="uom.group_uom"/>
                <field name="order_id" readonly="1"/>
                <field name="proc_state" readonly="1"/>
                <field name="state" invisible="1"/>
                <field name="company_id" optional="hide" groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <record id="sale_order_line_search_view_procurement" model="ir.ui.view">
        <field name="name">sale.order.line.search</field>
        <field name="model">sale.order.line</field>
        <field name="arch" type="xml">
            <search string="Procurement Order">
                <field name="product_id"/>
                <field name="order_id"/>
                <searchpanel>
                    <field name="proc_state"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <record model="ir.actions.act_window" id="action_sale_order_line_procurement">
        <field name="name">Procurement Sale Order Line</field>
        <field name="res_model">sale.order.line</field>
        <field name="view_mode">pivot,tree</field>
        <field name="domain">[('proc_plan_id', 'in', active_ids)]</field>
        <field name="search_view_id" ref="app_procurement_plan.sale_order_line_search_view_procurement"/>
        <field name="view_ids" eval="[
            (5, 0, 0),
            (0, 0, {'view_mode': 'tree', 'view_id': ref('app_procurement_plan.sale_order_line_tree_view_procurement')})]"/>
    </record>

</odoo>
